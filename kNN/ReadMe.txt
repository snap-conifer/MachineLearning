程序的详细分析，请参考
http://blog.csdn.net/haishu_zheng/article/details/77579404